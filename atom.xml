<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Hexo</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2017-08-15T15:02:06.967Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Private Li</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title></title>
    <link href="http://yoursite.com/2017/08/19/Etcd%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2/"/>
    <id>http://yoursite.com/2017/08/19/Etcd安装部署/</id>
    <published>2017-08-19T15:26:28.006Z</published>
    <updated>2017-08-15T15:02:06.967Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Etcd安装"><a href="#Etcd安装" class="headerlink" title="Etcd安装"></a>Etcd安装</h2><ul>
<li><p>安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">cd /usr/local/</div><div class="line"></div><div class="line">#etcd存储地址</div><div class="line">DOWNLOAD_URL=https://github.com/coreos/etcd/releases/download</div><div class="line">#设置etcd版本号</div><div class="line">ETCD_VER=v3.2.5</div><div class="line">wget $&#123;DOWNLOAD_URL&#125;/$&#123;ETCD_VER&#125;/etcd-$&#123;ETCD_VER&#125;-linux-amd64.tar.gz</div><div class="line">tar -zxvf etcd-$&#123;ETCD_VER&#125;-linux-amd64.tar.gz</div><div class="line">ln -s etcd-v3.2.5-linux-amd64 etcd</div><div class="line"></div><div class="line">cp etcd/etcd* /usr/bin/</div></pre></td></tr></table></figure>
</li>
<li><p>配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div></pre></td><td class="code"><pre><div class="line">vi etcd.sh</div><div class="line">#!/bin/bash</div><div class="line"></div><div class="line"># Copyright 2014 The Kubernetes Authors.</div><div class="line">#</div><div class="line"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</div><div class="line"># you may not use this file except in compliance with the License.</div><div class="line"># You may obtain a copy of the License at</div><div class="line">#</div><div class="line">#     http://www.apache.org/licenses/LICENSE-2.0</div><div class="line">#</div><div class="line"># Unless required by applicable law or agreed to in writing, software</div><div class="line"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</div><div class="line"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</div><div class="line"># See the License for the specific language governing permissions and</div><div class="line"># limitations under the License.</div><div class="line"></div><div class="line">## Create etcd.conf, etcd.service, and start etcd service.</div><div class="line"></div><div class="line">ETCD_NAME=`hostname`</div><div class="line">ETCD_DATA_DIR=/var/lib/etcd</div><div class="line">ETCD_CONF_DIR=/etc/etcd</div><div class="line">ETCD_CLUSTER=&apos;k8s-1=http://192.168.111.3:2380,k8s-2=http://192.168.111.4:2380,k8s-3=http://192.168.111.5:2380&apos;</div><div class="line">ETCD_LISTEN_IP=`ip addr show ens33 |grep -w &apos;inet&apos; |awk -F &quot; &quot; &apos;&#123;print $2&#125;&apos; |awk -F &quot;/&quot; &apos;&#123;print $1&#125;&apos;`</div><div class="line"></div><div class="line">useradd etcd</div><div class="line">mkdir -p $ETCD_DATA_DIR $ETCD_CONF_DIR</div><div class="line">chown -R etcd.etcd $ETCD_DATA_DIR</div><div class="line"></div><div class="line">cat &lt;&lt;EOF &gt;/etc/etcd/etcd.conf</div><div class="line"># [member]</div><div class="line">ETCD_NAME=$&#123;ETCD_NAME&#125;</div><div class="line">ETCD_DATA_DIR=&quot;/var/lib/etcd/default.etcd&quot;</div><div class="line">#ETCD_WAL_DIR=&quot;&quot;</div><div class="line">ETCD_SNAPSHOT_COUNT=&quot;10000&quot;</div><div class="line">ETCD_HEARTBEAT_INTERVAL=&quot;100&quot;</div><div class="line">ETCD_ELECTION_TIMEOUT=&quot;1000&quot;</div><div class="line">ETCD_LISTEN_PEER_URLS=&quot;http://$&#123;ETCD_LISTEN_IP&#125;:2380&quot;</div><div class="line">ETCD_LISTEN_CLIENT_URLS=&quot;http://$&#123;ETCD_LISTEN_IP&#125;:2379,http://127.0.0.1:2379&quot;</div><div class="line">ETCD_MAX_SNAPSHOTS=&quot;5&quot;</div><div class="line">ETCD_MAX_WALS=&quot;5&quot;</div><div class="line">#ETCD_CORS=&quot;&quot;</div><div class="line">#</div><div class="line">#[cluster]</div><div class="line">ETCD_INITIAL_ADVERTISE_PEER_URLS=&quot;http://$&#123;ETCD_LISTEN_IP&#125;:2380&quot;</div><div class="line"># if you use different ETCD_NAME (e.g. test), set ETCD_INITIAL_CLUSTER value for this name, i.e. &quot;test=http://...&quot;</div><div class="line">ETCD_INITIAL_CLUSTER=&quot;$&#123;ETCD_CLUSTER&#125;&quot;</div><div class="line">ETCD_INITIAL_CLUSTER_STATE=&quot;new&quot;</div><div class="line">ETCD_INITIAL_CLUSTER_TOKEN=&quot;etcd-cluster&quot;</div><div class="line">ETCD_ADVERTISE_CLIENT_URLS=&quot;http://$&#123;ETCD_LISTEN_IP&#125;:2379&quot;</div><div class="line">#ETCD_DISCOVERY=&quot;&quot;</div><div class="line">#ETCD_DISCOVERY_SRV=&quot;&quot;</div><div class="line">#ETCD_DISCOVERY_FALLBACK=&quot;proxy&quot;</div><div class="line">#ETCD_DISCOVERY_PROXY=&quot;&quot;</div><div class="line">#ETCD_STRICT_RECONFIG_CHECK=&quot;false&quot;</div><div class="line">#ETCD_AUTO_COMPACTION_RETENTION=&quot;0&quot;</div><div class="line">#</div><div class="line">#[proxy]</div><div class="line">#ETCD_PROXY=&quot;off&quot;</div><div class="line">#ETCD_PROXY_FAILURE_WAIT=&quot;5000&quot;</div><div class="line">#ETCD_PROXY_REFRESH_INTERVAL=&quot;30000&quot;</div><div class="line">#ETCD_PROXY_DIAL_TIMEOUT=&quot;1000&quot;</div><div class="line">#ETCD_PROXY_WRITE_TIMEOUT=&quot;5000&quot;</div><div class="line">#ETCD_PROXY_READ_TIMEOUT=&quot;0&quot;</div><div class="line">#</div><div class="line">#[security]</div><div class="line">#ETCD_CERT_FILE=&quot;&quot;</div><div class="line">#ETCD_KEY_FILE=&quot;&quot;</div><div class="line">#ETCD_CLIENT_CERT_AUTH=&quot;false&quot;</div><div class="line">#ETCD_TRUSTED_CA_FILE=&quot;&quot;</div><div class="line">#ETCD_AUTO_TLS=&quot;false&quot;</div><div class="line">#ETCD_PEER_CERT_FILE=&quot;&quot;</div><div class="line">#ETCD_PEER_KEY_FILE=&quot;&quot;</div><div class="line">#ETCD_PEER_CLIENT_CERT_AUTH=&quot;false&quot;</div><div class="line">#ETCD_PEER_TRUSTED_CA_FILE=&quot;&quot;</div><div class="line">#ETCD_PEER_AUTO_TLS=&quot;false&quot;</div><div class="line">#</div><div class="line">#[logging]</div><div class="line">#ETCD_DEBUG=&quot;false&quot;</div><div class="line"># examples for -log-package-levels etcdserver=WARNING,security=DEBUG</div><div class="line">#ETCD_LOG_PACKAGE_LEVELS=&quot;&quot;</div><div class="line">EOF</div><div class="line"></div><div class="line">cat &lt;&lt;EOF &gt;/usr/lib/systemd/system/etcd.service</div><div class="line">[Unit]</div><div class="line">Description=Etcd Server</div><div class="line">After=network.target</div><div class="line">After=network-online.target</div><div class="line">Wants=network-online.target</div><div class="line"></div><div class="line">[Service]</div><div class="line">Type=notify</div><div class="line">WorkingDirectory=/var/lib/etcd/</div><div class="line">EnvironmentFile=-/etc/etcd/etcd.conf</div><div class="line">User=etcd</div><div class="line"># set GOMAXPROCS to number of processors</div><div class="line">#ExecStart=/bin/bash -c &quot;GOMAXPROCS=$(nproc) /usr/bin/etcd --name=\&quot;$&#123;ETCD_NAME&#125;\&quot; --data-dir=\&quot;$&#123;ETCD_DATA_DIR&#125;\&quot; --listen-client-urls=\&quot;$&#123;ETCD_LISTEN_CLIENT_URLS&#125;\&quot;&quot;</div><div class="line">ExecStart=/bin/bash -c &quot;GOMAXPROCS=$(nproc) /usr/bin/etcd&quot;</div><div class="line">Restart=on-failure</div><div class="line">LimitNOFILE=65536</div><div class="line"></div><div class="line">[Install]</div><div class="line">WantedBy=multi-user.target</div><div class="line">EOF</div><div class="line"></div><div class="line">sh etcd.sh</div></pre></td></tr></table></figure>
</li>
<li><p>启动</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">systemctl daemon-reload</div><div class="line">systemctl enable etcd</div><div class="line">systemctl restart etcd</div></pre></td></tr></table></figure>
</li>
<li><p>测试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">etcdctl cluster-health</div></pre></td></tr></table></figure>
</li>
<li><p>参考</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">http://www.cnblogs.com/yangxiaoyi/p/6892177.html</div><div class="line">http://rootsongjc.github.io/blogs/kubernetes-installation-on-centos/</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Docker-CE-安装"><a href="#Docker-CE-安装" class="headerlink" title="Docker CE 安装"></a>Docker CE 安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line">yum -y install yum-utils.noarch device-mapper-persistent-data.x86_64 lvm2.x86_64</div><div class="line"></div><div class="line">vi /etc/yum.repos.d/docker-ce.repo</div><div class="line">[docker-ce-stable]</div><div class="line">name=Docker CE Stable - $basearch</div><div class="line">baseurl=https://mirrors.aliyun.com/docker-ce/linux/centos/7/$basearch/stable</div><div class="line">enabled=1</div><div class="line">gpgcheck=1</div><div class="line">gpgkey=https://mirrors.aliyun.com/docker-ce/linux/centos/gpg</div><div class="line"></div><div class="line">[docker-ce-stable-debuginfo]</div><div class="line">name=Docker CE Stable - Debuginfo $basearch</div><div class="line">baseurl=https://mirrors.aliyun.com/docker-ce/linux/centos/7/debug-$basearch/stable</div><div class="line">enabled=0</div><div class="line">gpgcheck=1</div><div class="line">gpgkey=https://mirrors.aliyun.com/docker-ce/linux/centos/gpg</div><div class="line"></div><div class="line">[docker-ce-stable-source]</div><div class="line">name=Docker CE Stable - Sources</div><div class="line">baseurl=https://mirrors.aliyun.com/docker-ce/linux/centos/7/source/stable</div><div class="line">enabled=0</div><div class="line">gpgcheck=1</div><div class="line">gpgkey=https://mirrors.aliyun.com/docker-ce/linux/centos/gpg</div><div class="line"></div><div class="line">[docker-ce-edge]</div><div class="line">name=Docker CE Edge - $basearch</div><div class="line">baseurl=https://mirrors.aliyun.com/docker-ce/linux/centos/7/$basearch/edge</div><div class="line">enabled=0</div><div class="line">gpgcheck=1</div><div class="line">gpgkey=https://mirrors.aliyun.com/docker-ce/linux/centos/gpg</div><div class="line"></div><div class="line">[docker-ce-edge-debuginfo]</div><div class="line">name=Docker CE Edge - Debuginfo $basearch</div><div class="line">baseurl=https://mirrors.aliyun.com/docker-ce/linux/centos/7/debug-$basearch/edge</div><div class="line">enabled=0</div><div class="line">gpgcheck=1</div><div class="line">gpgkey=https://mirrors.aliyun.com/docker-ce/linux/centos/gpg</div><div class="line"></div><div class="line">[docker-ce-edge-source]</div><div class="line">name=Docker CE Edge - Sources</div><div class="line">baseurl=https://mirrors.aliyun.com/docker-ce/linux/centos/7/source/edge</div><div class="line">enabled=0</div><div class="line">gpgcheck=1</div><div class="line">gpgkey=https://mirrors.aliyun.com/docker-ce/linux/centos/gpg</div><div class="line"></div><div class="line">[docker-ce-test]</div><div class="line">name=Docker CE Test - $basearch</div><div class="line">baseurl=https://mirrors.aliyun.com/docker-ce/linux/centos/7/$basearch/test</div><div class="line">enabled=0</div><div class="line">gpgcheck=1</div><div class="line">gpgkey=https://mirrors.aliyun.com/docker-ce/linux/centos/gpg</div><div class="line"></div><div class="line">[docker-ce-test-debuginfo]</div><div class="line">name=Docker CE Test - Debuginfo $basearch</div><div class="line">baseurl=https://mirrors.aliyun.com/docker-ce/linux/centos/7/debug-$basearch/test</div><div class="line">enabled=0</div><div class="line">gpgcheck=1</div><div class="line">gpgkey=https://mirrors.aliyun.com/docker-ce/linux/centos/gpg</div><div class="line"></div><div class="line">[docker-ce-test-source]</div><div class="line">name=Docker CE Test - Sources</div><div class="line">baseurl=https://mirrors.aliyun.com/docker-ce/linux/centos/7/source/test</div><div class="line">enabled=0</div><div class="line">gpgcheck=1</div><div class="line">gpgkey=https://mirrors.aliyun.com/docker-ce/linux/centos/gpg</div><div class="line"></div><div class="line">yum makecache fast</div><div class="line"></div><div class="line">yum -y install docker-ce.x86_64</div><div class="line"></div><div class="line">systemctl enable docker.service</div><div class="line">systemctl restart docker.service</div></pre></td></tr></table></figure>
<h2 id="Kubernetes安装"><a href="#Kubernetes安装" class="headerlink" title="Kubernetes安装"></a>Kubernetes安装</h2><ul>
<li>安装</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">wget https://github.com/kubernetes/kubernetes/releases/download/v1.7.3/kubernetes.tar.gz</div><div class="line">tar -zxvf kubernetes.tar.gz</div><div class="line"></div><div class="line">cd kubernetes</div><div class="line">./cluster/get-kube-binaries.sh</div><div class="line"></div><div class="line">cd server</div><div class="line">tar -zxvf kubernetes-server-linux-amd64.tar.gz</div><div class="line">cd kubernetes/server/bin/</div><div class="line">rm -f *_tag *.tar</div><div class="line">chmod 755 *</div><div class="line">mv * /usr/bin</div></pre></td></tr></table></figure>
<ul>
<li>配置</li>
</ul>
<ol>
<li>Master节点配置</li>
</ol>
<ul>
<li>配置kube-apiserver</li>
</ul>
<p>kube-apiserver.service<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">vi /usr/lib/systemd/system/kube-apiserver.service</div><div class="line">[Unit]</div><div class="line">Description=Kubernetes API Service</div><div class="line">Documentation=https://github.com/GoogleCloudPlatform/kubernetes</div><div class="line">After=network.target</div><div class="line">After=etcd.service</div><div class="line"></div><div class="line">[Service]</div><div class="line">EnvironmentFile=-/etc/kubernetes/config</div><div class="line">EnvironmentFile=-/etc/kubernetes/apiserver</div><div class="line">ExecStart=/usr/bin/kube-apiserver \</div><div class="line">            $KUBE_LOGTOSTDERR \</div><div class="line">            $KUBE_LOG_LEVEL \</div><div class="line">            $KUBE_ETCD_SERVERS \</div><div class="line">            $KUBE_API_ADDRESS \</div><div class="line">            $KUBE_API_PORT \</div><div class="line">            $KUBELET_PORT \</div><div class="line">            $KUBE_ALLOW_PRIV \</div><div class="line">            $KUBE_SERVICE_ADDRESSES \</div><div class="line">            $KUBE_ADMISSION_CONTROL \</div><div class="line">            $KUBE_API_ARGS</div><div class="line">Restart=on-failure</div><div class="line">Type=notify</div><div class="line">LimitNOFILE=65536</div><div class="line"></div><div class="line">[Install]</div><div class="line">WantedBy=multi-user.target</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mkdir /etc/kubernetes</div></pre></td></tr></table></figure>
<p>config<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">vi /etc/kubernetes/config</div><div class="line">###</div><div class="line"># kubernetes system config</div><div class="line">#</div><div class="line"># The following values are used to configure various aspects of all</div><div class="line"># kubernetes services, including</div><div class="line">#</div><div class="line">#   kube-apiserver.service</div><div class="line">#   kube-controller-manager.service</div><div class="line">#   kube-scheduler.service</div><div class="line">#   kubelet.service</div><div class="line">#   kube-proxy.service</div><div class="line"># logging to stderr means we get it in the systemd journal</div><div class="line">KUBE_LOGTOSTDERR=&quot;--logtostderr=true&quot;</div><div class="line"></div><div class="line"># journal message level, 0 is debug</div><div class="line">KUBE_LOG_LEVEL=&quot;--v=0&quot;</div><div class="line"></div><div class="line"># Should this cluster be allowed to run privileged docker containers</div><div class="line">KUBE_ALLOW_PRIV=&quot;--allow-privileged=false&quot;</div><div class="line"></div><div class="line"># How the controller-manager, scheduler, and proxy find the apiserver</div><div class="line">KUBE_MASTER=&quot;--master=http://k8s-1.test.com:8080&quot;</div></pre></td></tr></table></figure></p>
<p>apiserver<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">vi /etc/kubernetes/apiserver</div><div class="line">###</div><div class="line">## kubernetes system config</div><div class="line">##</div><div class="line">## The following values are used to configure the kube-apiserver</div><div class="line">##</div><div class="line">#</div><div class="line">## The address on the local server to listen to.</div><div class="line">KUBE_API_ADDRESS=&quot;--address=0.0.0.0&quot;</div><div class="line">#</div><div class="line">## The port on the local server to listen on.</div><div class="line">KUBE_API_PORT=&quot;--port=8080&quot;</div><div class="line">#</div><div class="line">## Port minions listen on</div><div class="line">KUBELET_PORT=&quot;--kubelet-port=10250&quot;</div><div class="line">#</div><div class="line">## Comma separated list of nodes in the etcd cluster</div><div class="line">KUBE_ETCD_SERVERS=&quot;--etcd-servers=http://192.168.111.3:2379,192.168.111.4:2379,192.168.111.5:2379&quot;</div><div class="line">#</div><div class="line">## Address range to use for services</div><div class="line">KUBE_SERVICE_ADDRESSES=&quot;--service-cluster-ip-range=192.168.111.0/24&quot;</div><div class="line">#</div><div class="line">## default admission control policies</div><div class="line">KUBE_ADMISSION_CONTROL=&quot;--admission-control=NamespaceLifecycle,NamespaceExists,LimitRanger,SecurityContextDeny,ResourceQuota&quot;</div><div class="line">#</div><div class="line">## Add your own!</div><div class="line">#KUBE_API_ARGS=&quot;&quot;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>–admission-control参数是Kubernetes的安全机制配置，这些安全机制都是以插件的形式用来对API Serve进行准入控制，一开始我们没有配置ServiceAccount，这是为了方便集群之间的通信，不需要进行身份验证。如果你需要更高级的身份验证和鉴权的话就需要加上它了。</p>
</blockquote>
<ul>
<li>配置kube-controller-manager</li>
</ul>
<p>kube-controller-manager.service<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">vi /usr/lib/systemd/system/kube-controller-manager.service</div><div class="line">[Unit]</div><div class="line">Description=Kubernetes Controller Manager</div><div class="line">Documentation=https://github.com/GoogleCloudPlatform/kubernetes</div><div class="line"></div><div class="line">[Service]</div><div class="line">EnvironmentFile=-/etc/kubernetes/config</div><div class="line">EnvironmentFile=-/etc/kubernetes/controller-manager</div><div class="line">ExecStart=/usr/bin/kube-controller-manager \</div><div class="line">            $KUBE_LOGTOSTDERR \</div><div class="line">            $KUBE_LOG_LEVEL \</div><div class="line">            $KUBE_MASTER \</div><div class="line">            $KUBE_CONTROLLER_MANAGER_ARGS</div><div class="line">Restart=on-failure</div><div class="line">LimitNOFILE=65536</div><div class="line"></div><div class="line">[Install]</div><div class="line">WantedBy=multi-user.target</div></pre></td></tr></table></figure></p>
<p>controller-manager</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">vi /etc/kubernetes/controller-manager###</div><div class="line"># The following values are used to configure the kubernetes controller-manager</div><div class="line"></div><div class="line"># defaults from config and apiserver should be adequate</div><div class="line"></div><div class="line"># Add your own!</div><div class="line">KUBE_CONTROLLER_MANAGER_ARGS=&quot;&quot;</div></pre></td></tr></table></figure>
<ul>
<li>配置kube-scheduler</li>
</ul>
<p>kube-scheduler.service<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">vi /usr/lib/systemd/system/kube-scheduler.service</div><div class="line">[Unit]</div><div class="line">Description=Kubernetes Scheduler Plugin</div><div class="line">Documentation=https://github.com/GoogleCloudPlatform/kubernetes</div><div class="line"></div><div class="line">[Service]</div><div class="line">EnvironmentFile=-/etc/kubernetes/config</div><div class="line">EnvironmentFile=-/etc/kubernetes/scheduler</div><div class="line">ExecStart=/usr/bin/kube-scheduler \</div><div class="line">            $KUBE_LOGTOSTDERR \</div><div class="line">            $KUBE_LOG_LEVEL \</div><div class="line">            $KUBE_MASTER \</div><div class="line">            $KUBE_SCHEDULER_ARGS</div><div class="line">Restart=on-failure</div><div class="line">LimitNOFILE=65536</div><div class="line"></div><div class="line">[Install]</div><div class="line">WantedBy=multi-user.target</div></pre></td></tr></table></figure></p>
<p>scheduler</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">vi /etc/kubernetes/scheduler</div><div class="line">###</div><div class="line"># kubernetes scheduler config</div><div class="line"></div><div class="line"># default config should be adequate</div><div class="line"></div><div class="line"># Add your own!</div><div class="line">KUBE_SCHEDULER_ARGS=&quot;&quot;</div></pre></td></tr></table></figure>
<ul>
<li>配置kube-proxy</li>
</ul>
<p>kube-proxy.service</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">vi /usr/lib/systemd/system/kube-proxy.service</div><div class="line">[Unit]</div><div class="line">Description=Kubernetes Kube-Proxy Server</div><div class="line">Documentation=https://github.com/GoogleCloudPlatform/kubernetes</div><div class="line">After=network.target</div><div class="line"></div><div class="line">[Service]</div><div class="line">EnvironmentFile=-/etc/kubernetes/config</div><div class="line">EnvironmentFile=-/etc/kubernetes/proxy</div><div class="line">ExecStart=/usr/bin/kube-proxy \</div><div class="line">	    $KUBE_LOGTOSTDERR \</div><div class="line">	    $KUBE_LOG_LEVEL \</div><div class="line">	    $KUBE_MASTER \</div><div class="line">	    $KUBE_PROXY_ARGS</div><div class="line">Restart=on-failure</div><div class="line">LimitNOFILE=65536</div><div class="line"></div><div class="line">[Install]</div><div class="line">WantedBy=multi-user.target</div></pre></td></tr></table></figure>
<p>proxy</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">vi /etc/kubernetes/proxy</div><div class="line">###</div><div class="line"># kubernetes proxy config</div><div class="line"></div><div class="line"># default config should be adequate</div><div class="line"></div><div class="line"># Add your own!</div><div class="line">KUBE_PROXY_ARGS=&quot;&quot;</div></pre></td></tr></table></figure>
<ul>
<li>配置kubelet</li>
</ul>
<p>kubelet.service</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">mkdir -p /var/lib/kubelet</div><div class="line"></div><div class="line">vi /usr/lib/systemd/system/kubelet.service</div><div class="line">[Unit]</div><div class="line">Description=Kubernetes Kubelet Server</div><div class="line">Documentation=https://github.com/GoogleCloudPlatform/kubernetes</div><div class="line">After=docker.service</div><div class="line">Requires=docker.service</div><div class="line"></div><div class="line">[Service]</div><div class="line">WorkingDirectory=/var/lib/kubelet</div><div class="line">EnvironmentFile=-/etc/kubernetes/config</div><div class="line">EnvironmentFile=-/etc/kubernetes/kubelet</div><div class="line">ExecStart=/usr/bin/kubelet \</div><div class="line">	    $KUBE_LOGTOSTDERR \</div><div class="line">	    $KUBE_LOG_LEVEL \</div><div class="line">	    $KUBELET_API_SERVER \</div><div class="line">	    $KUBELET_ADDRESS \</div><div class="line">	    $KUBELET_PORT \</div><div class="line">	    $KUBELET_HOSTNAME \</div><div class="line">	    $KUBE_ALLOW_PRIV \</div><div class="line">	    $KUBELET_POD_INFRA_CONTAINER \</div><div class="line">	    $KUBELET_ARGS</div><div class="line">Restart=on-failure</div><div class="line"></div><div class="line">[Install]</div><div class="line">WantedBy=multi-user.target</div></pre></td></tr></table></figure>
<p>kubelet</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">vi /etc/kubernetes/kubelet</div><div class="line">###</div><div class="line">## kubernetes kubelet (minion) config</div><div class="line">#</div><div class="line">## The address for the info server to serve on (set to 0.0.0.0 or &quot;&quot; for all interfaces)</div><div class="line">KUBELET_ADDRESS=&quot;--address=0.0.0.0&quot;</div><div class="line">#</div><div class="line">## The port for the info server to serve on</div><div class="line">KUBELET_PORT=&quot;--port=10250&quot;</div><div class="line">#</div><div class="line">## You may leave this blank to use the actual hostname</div><div class="line">KUBELET_HOSTNAME=&quot;--hostname-override=k8s-1.test.com&quot;</div><div class="line">#</div><div class="line">## location of the api-server</div><div class="line">KUBELET_API_SERVER=&quot;--api-servers=http://k8s-1.test.com:8080&quot;</div><div class="line">#</div><div class="line">## pod infrastructure container</div><div class="line">KUBELET_POD_INFRA_CONTAINER=&quot;--pod-infra-container-image=registry.access.redhat.com/rhel7/pod-infrastructure:latest&quot;</div><div class="line">#</div><div class="line">## Add your own!</div><div class="line">KUBELET_ARGS=&quot;&quot;</div></pre></td></tr></table></figure>
<ol>
<li>Node节点配置 </li>
</ol>
<ul>
<li>配置kube-proxy</li>
</ul>
<p>kube-proxy.service</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">vi /usr/lib/systemd/system/kube-proxy.service</div><div class="line">[Unit]</div><div class="line">Description=Kubernetes Kube-Proxy Server</div><div class="line">Documentation=https://github.com/GoogleCloudPlatform/kubernetes</div><div class="line">After=network.target</div><div class="line"></div><div class="line">[Service]</div><div class="line">EnvironmentFile=-/etc/kubernetes/config</div><div class="line">EnvironmentFile=-/etc/kubernetes/proxy</div><div class="line">ExecStart=/usr/bin/kube-proxy \</div><div class="line">	    $KUBE_LOGTOSTDERR \</div><div class="line">	    $KUBE_LOG_LEVEL \</div><div class="line">	    $KUBE_MASTER \</div><div class="line">	    $KUBE_PROXY_ARGS</div><div class="line">Restart=on-failure</div><div class="line">LimitNOFILE=65536</div><div class="line"></div><div class="line">[Install]</div><div class="line">WantedBy=multi-user.target</div></pre></td></tr></table></figure>
<p>proxy</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">vi /etc/kubernetes/proxy</div><div class="line">###</div><div class="line"># kubernetes proxy config</div><div class="line"></div><div class="line"># default config should be adequate</div><div class="line"></div><div class="line"># Add your own!</div><div class="line">KUBE_PROXY_ARGS=&quot;&quot;</div></pre></td></tr></table></figure>
<ul>
<li>配置kubelet</li>
<li>kubelet.service</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">mkdir -p /var/lib/kubelet</div><div class="line"></div><div class="line">vi /usr/lib/systemd/system/kubelet.service</div><div class="line">[Unit]</div><div class="line">Description=Kubernetes Kubelet Server</div><div class="line">Documentation=https://github.com/GoogleCloudPlatform/kubernetes</div><div class="line">After=docker.service</div><div class="line">Requires=docker.service</div><div class="line"></div><div class="line">[Service]</div><div class="line">WorkingDirectory=/var/lib/kubelet</div><div class="line">EnvironmentFile=-/etc/kubernetes/config</div><div class="line">EnvironmentFile=-/etc/kubernetes/kubelet</div><div class="line">ExecStart=/usr/bin/kubelet \</div><div class="line">	    $KUBE_LOGTOSTDERR \</div><div class="line">	    $KUBE_LOG_LEVEL \</div><div class="line">	    $KUBELET_API_SERVER \</div><div class="line">	    $KUBELET_ADDRESS \</div><div class="line">	    $KUBELET_PORT \</div><div class="line">	    $KUBELET_HOSTNAME \</div><div class="line">	    $KUBE_ALLOW_PRIV \</div><div class="line">	    $KUBELET_POD_INFRA_CONTAINER \</div><div class="line">	    $KUBELET_ARGS</div><div class="line">Restart=on-failure</div><div class="line"></div><div class="line">[Install]</div><div class="line">WantedBy=multi-user.target</div></pre></td></tr></table></figure>
<p>kubelet</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">vi /etc/kubernetes/kubelet</div><div class="line">###</div><div class="line">## kubernetes kubelet (minion) config</div><div class="line">#</div><div class="line">## The address for the info server to serve on (set to 0.0.0.0 or &quot;&quot; for all interfaces)</div><div class="line">KUBELET_ADDRESS=&quot;--address=0.0.0.0&quot;</div><div class="line">#</div><div class="line">## The port for the info server to serve on</div><div class="line">KUBELET_PORT=&quot;--port=10250&quot;</div><div class="line">#</div><div class="line">## You may leave this blank to use the actual hostname</div><div class="line">#KUBELET_HOSTNAME=&quot;--hostname-override=k8s-2.test.com&quot;</div><div class="line">KUBELET_HOSTNAME=&quot;--hostname-override=k8s-3.test.com&quot;</div><div class="line">#</div><div class="line">## location of the api-server</div><div class="line">KUBELET_API_SERVER=&quot;--api-servers=http://k8s-1.test.com:8080&quot;</div><div class="line">#</div><div class="line">## pod infrastructure container</div><div class="line">KUBELET_POD_INFRA_CONTAINER=&quot;--pod-infra-container-image=registry.access.redhat.com/rhel7/pod-infrastructure:latest&quot;</div><div class="line">#</div><div class="line">## Add your own!</div><div class="line">KUBELET_ARGS=&quot;&quot;</div></pre></td></tr></table></figure>
<ul>
<li>启动</li>
</ul>
<ol>
<li>Master节点</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">vi master.sh</div><div class="line">for SERVICES in kube-apiserver kube-controller-manager kube-scheduler kube-proxy kubelet</div><div class="line">do</div><div class="line">  systemctl restart $SERVICES</div><div class="line">  systemctl enable $SERVICES</div><div class="line">  systemctl status $SERVICES</div><div class="line">done</div></pre></td></tr></table></figure>
<ol>
<li>Node节点</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">vi node.sh</div><div class="line">for SERVICES in kube-proxy kubelet</div><div class="line">do</div><div class="line">  systemctl restart $SERVICES</div><div class="line">  systemctl enable $SERVICES</div><div class="line">  systemctl status $SERVICES</div><div class="line">done</div></pre></td></tr></table></figure>
<ul>
<li>验证</li>
</ul>
<p>在Master节点上运行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">kubectl get all</div><div class="line">NAME             CLUSTER-IP      EXTERNAL-IP   PORT(S)   AGE</div><div class="line">svc/kubernetes   192.168.111.1   &lt;none&gt;        443/TCP   4h</div><div class="line">kubectl get nodes</div><div class="line">NAME             STATUS    AGE       VERSION</div><div class="line">k8s-1.test.com   Ready     7m        v1.7.3</div><div class="line">k8s-2.test.com   Ready     3m        v1.7.3</div><div class="line">k8s-3.test.com   Ready     2m        v1.7.3</div></pre></td></tr></table></figure>
<ul>
<li><a href="http://rootsongjc.github.io/blogs/kubernetes-installation-on-centos/" target="_blank" rel="external">http://rootsongjc.github.io/blogs/kubernetes-installation-on-centos/</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Etcd安装&quot;&gt;&lt;a href=&quot;#Etcd安装&quot; class=&quot;headerlink&quot; title=&quot;Etcd安装&quot;&gt;&lt;/a&gt;Etcd安装&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;安装&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://yoursite.com/2017/08/19/Kubernetes/"/>
    <id>http://yoursite.com/2017/08/19/Kubernetes/</id>
    <published>2017-08-19T15:23:20.171Z</published>
    <updated>2017-08-16T07:21:55.231Z</updated>
    
    <content type="html"><![CDATA[<ol>
<li>主机</li>
</ol>
<table>
<thead>
<tr>
<th>IP</th>
<th>hostname</th>
<th>角色</th>
<th>服务</th>
</tr>
</thead>
<tbody>
<tr>
<td>192.168.111.6</td>
<td>k8s-1</td>
<td>master</td>
<td>etcd、kube-apiserver、kube-scheduler、kube-controller-manager</td>
</tr>
<tr>
<td>192.168.111.7</td>
<td>k8s-2</td>
<td>minion</td>
<td>etcd、docker、kube-proxy、kubelet、flannel</td>
</tr>
<tr>
<td>192.168.111.8</td>
<td>k8s-2</td>
<td>minion</td>
<td>etcd、docker、kube-proxy、kubelet、flannel</td>
</tr>
</tbody>
</table>
<ol>
<li>准备</li>
</ol>
<ul>
<li>关闭服务器</li>
</ul>
<p>在3台主机上关闭防火墙，下面以k8s-1主机为例进行讲解：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[root@k8s-1 ~]# systemctl disable firewalld.service</div><div class="line">[root@k8s-1 ~]# systemctl stop firewalld.service</div><div class="line">[root@k8s-1 ~]# systemctl status firewalld.service</div></pre></td></tr></table></figure>
<ul>
<li>禁用SELinux</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">vi /etc/selinux/config</div><div class="line">SELINUX=disabled</div></pre></td></tr></table></figure>
<p>之后重启机器使设置生效。</p>
<ol>
<li>Etcd安装和配置<blockquote>
<p>以下操作在3台主机上均进行，以k8s-1主机为例进行讲解</p>
</blockquote>
</li>
</ol>
<ul>
<li>安装</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@k8s-1 ~]# yum -y install etcd.x86_64</div></pre></td></tr></table></figure>
<ul>
<li>配置</li>
</ul>
<p>修改/etc/etcd/etcd.conf配置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[root@k8s-1 ~]# cp /etc/etcd/etcd.conf /etc/etcd/etcd.conf.bak</div><div class="line">[root@k8s-1 ~]# sed -i &quot;s#ETCD_NAME=default#ETCD_NAME=`hostname`#g&quot; /etc/etcd/etcd.conf</div><div class="line">[root@k8s-1 ~]# sed -i &apos;s@#ETCD_LISTEN_PEER_URLS=&quot;http://localhost:2380&quot;@ETCD_LISTEN_PEER_URLS=&quot;http://0.0.0.0:2380&quot;@g&apos; /etc/etcd/etcd.conf</div><div class="line">[root@k8s-1 ~]# sed -i &apos;s@ETCD_LISTEN_CLIENT_URLS=&quot;http://localhost:2379&quot;@ETCD_LISTEN_CLIENT_URLS=&quot;http://0.0.0.0:2379&quot;@g&apos; /etc/etcd/etcd.conf</div><div class="line">[root@k8s-1 ~]# sed -i &apos;s@#ETCD_INITIAL_ADVERTISE_PEER_URLS=&quot;http://localhost:2380&quot;@ETCD_INITIAL_ADVERTISE_PEER_URLS=&quot;http://0.0.0.0:2380&quot;@g&apos; /etc/etcd/etcd.conf</div><div class="line">[root@k8s-1 ~]# sed -i &apos;s@#ETCD_INITIAL_CLUSTER=&quot;default=http://localhost:2380&quot;@ETCD_INITIAL_CLUSTER=&quot;k8s-1=http://192.168.111.6:2380,k8s-2=http://192.168.111.7:2380,k8s-3=http://192.168.111.8:2380&quot;@g&apos; /etc/etcd/etcd.conf</div><div class="line">[root@k8s-1 ~]# sed -i &apos;s@ETCD_ADVERTISE_CLIENT_URLS=&quot;http://localhost:2379&quot;@ETCD_ADVERTISE_CLIENT_URLS=&quot;http://0.0.0.0:2379&quot;@g&apos; /etc/etcd/etcd.conf</div></pre></td></tr></table></figure></p>
<ul>
<li><p>启动</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[root@k8s-1 ~]# systemctl daemon-reload</div><div class="line">[root@k8s-1 ~]# systemctl enable etcd.service</div><div class="line">[root@k8s-1 ~]# systemctl restart etcd.service</div><div class="line">[root@k8s-1 ~]# systemctl status etcd.service</div></pre></td></tr></table></figure>
</li>
<li><p>测试</p>
<blockquote>
<p>以下操作在3台主机的任意一台上执行即可，以k8s-1主机为例进行讲解</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@k8s-1 ~]# etcdctl cluster-health</div></pre></td></tr></table></figure>
</blockquote>
</li>
</ul>
<ol>
<li>kubernetes master安装和配置<blockquote>
<p>以下操作只在k8s-1主机上进行</p>
</blockquote>
</li>
</ol>
<ul>
<li><p>安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@k8s-1 ~]# yum -y install kubernetes-master.x86_64</div></pre></td></tr></table></figure>
</li>
<li><p>配置</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[root@k8s-1 ~]# HOST_IP=`ip addr show ens33 | grep -w &apos;inet&apos; | awk -F &quot; &quot; &apos;&#123;print $2&#125;&apos; | awk -F &quot;/&quot; &apos;&#123;print $1&#125;&apos;`</div><div class="line">[root@k8s-1 ~]# ETCD_SERVERS=&apos;http://192.168.111.6:2379,192.168.111.7:2379,192.168.111.8:2379&apos;</div><div class="line"></div><div class="line">[root@k8s-1 ~]# sed -i &quot;s#KUBE_MASTER=\&quot;--master=http://127.0.0.1:8080\&quot;#KUBE_MASTER=\&quot;--master=http://$&#123;HOST_IP&#125;:8080\&quot;#g&quot; /etc/kubernetes/config</div><div class="line">[root@k8s-1 ~]# sed -i &apos;s#KUBE_API_ADDRESS=&quot;--insecure-bind-address=127.0.0.1&quot;#KUBE_API_ADDRESS=&quot;--address=0.0.0.0&quot;#g&apos; /etc/kubernetes/apiserver</div><div class="line">[root@k8s-1 ~]# sed -i &quot;s#KUBE_ETCD_SERVERS=\&quot;--etcd-servers=http://127.0.0.1:2379\&quot;#KUBE_ETCD_SERVERS=\&quot;--etcd-servers=$&#123;ETCD_SERVERS&#125;\&quot;#g&quot; /etc/kubernetes/apiserver</div><div class="line">[root@k8s-1 ~]# sed -i &apos;s#KUBE_ADMISSION_CONTROL=&quot;--admission-control=NamespaceLifecycle,NamespaceExists,LimitRanger,SecurityContextDeny,ServiceAccount,ResourceQuota&quot;#KUBE_ADMISSION_CONTROL=&quot;--admission-control=NamespaceLifecycle,NamespaceExists,LimitRanger,SecurityContextDeny,ResourceQuota&quot;#g&apos; /etc/kubernetes/apiserver</div></pre></td></tr></table></figure>
<ul>
<li>启动</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[root@k8s-1 ~]# vi master_service.sh</div><div class="line">for SERVICE in kube-apiserver kube-controller-manager kube-scheduler</div><div class="line">do</div><div class="line">  systemctl enable $&#123;SERVICE&#125;.service</div><div class="line">  systemctl restart $&#123;SERVICE&#125;.service</div><div class="line">  systemctl status $&#123;SERVICE&#125;.service</div><div class="line">done</div></pre></td></tr></table></figure>
<ul>
<li>测试</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">[root@k8s-1 ~]# curl http://192.168.111.6:8080</div><div class="line">&#123;</div><div class="line">  &quot;paths&quot;: [</div><div class="line">    &quot;/api&quot;,</div><div class="line">    &quot;/api/v1&quot;,</div><div class="line">    &quot;/apis&quot;,</div><div class="line">    &quot;/apis/apps&quot;,</div><div class="line">    &quot;/apis/apps/v1beta1&quot;,</div><div class="line">    &quot;/apis/authentication.k8s.io&quot;,</div><div class="line">    &quot;/apis/authentication.k8s.io/v1beta1&quot;,</div><div class="line">    &quot;/apis/authorization.k8s.io&quot;,</div><div class="line">    &quot;/apis/authorization.k8s.io/v1beta1&quot;,</div><div class="line">    &quot;/apis/autoscaling&quot;,</div><div class="line">    &quot;/apis/autoscaling/v1&quot;,</div><div class="line">    &quot;/apis/batch&quot;,</div><div class="line">    &quot;/apis/batch/v1&quot;,</div><div class="line">    &quot;/apis/batch/v2alpha1&quot;,</div><div class="line">    &quot;/apis/certificates.k8s.io&quot;,</div><div class="line">    &quot;/apis/certificates.k8s.io/v1alpha1&quot;,</div><div class="line">    &quot;/apis/extensions&quot;,</div><div class="line">    &quot;/apis/extensions/v1beta1&quot;,</div><div class="line">    &quot;/apis/policy&quot;,</div><div class="line">    &quot;/apis/policy/v1beta1&quot;,</div><div class="line">    &quot;/apis/rbac.authorization.k8s.io&quot;,</div><div class="line">    &quot;/apis/rbac.authorization.k8s.io/v1alpha1&quot;,</div><div class="line">    &quot;/apis/storage.k8s.io&quot;,</div><div class="line">    &quot;/apis/storage.k8s.io/v1beta1&quot;,</div><div class="line">    &quot;/healthz&quot;,</div><div class="line">    &quot;/healthz/ping&quot;,</div><div class="line">    &quot;/healthz/poststarthook/bootstrap-controller&quot;,</div><div class="line">    &quot;/healthz/poststarthook/extensions/third-party-resources&quot;,</div><div class="line">    &quot;/healthz/poststarthook/rbac/bootstrap-roles&quot;,</div><div class="line">    &quot;/logs&quot;,</div><div class="line">    &quot;/metrics&quot;,</div><div class="line">    &quot;/swaggerapi/&quot;,</div><div class="line">    &quot;/ui/&quot;,</div><div class="line">    &quot;/version&quot;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ol>
<li>kubernetes node安装和配置<blockquote>
<p>以下操作在k8s-2和k8s-3两台主机上均执行，此处以k8s-2主机为例进行讲解</p>
</blockquote>
</li>
</ol>
<ul>
<li>安装</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@k8s-2 ~]# yum -y install kubernetes-node.x86_64</div></pre></td></tr></table></figure>
<ul>
<li>配置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[root@k8s-2 ~]# KUBE_MASTER=&apos;192.168.111.6&apos;</div><div class="line"></div><div class="line">[root@k8s-2 ~]# sed -i &quot;s#KUBE_MASTER=\&quot;--master=http://127.0.0.1:8080\&quot;#KUBE_MASTER=\&quot;--master=http://$&#123;KUBE_MASTER&#125;:8080\&quot;#g&quot; /etc/kubernetes/config</div><div class="line">[root@k8s-2 ~]# sed -i &apos;s#KUBELET_ADDRESS=&quot;--address=127.0.0.1&quot;#KUBELET_ADDRESS=&quot;--address=0.0.0.0&quot;#g&apos; /etc/kubernetes/kubelet</div><div class="line">[root@k8s-2 ~]# sed -i &quot;s#KUBELET_HOSTNAME=\&quot;--hostname-override=127.0.0.1\&quot;#KUBELET_HOSTNAME=\&quot;--hostname-override=`hostname`\&quot;#g&quot; /etc/kubernetes/kubelet</div><div class="line">[root@k8s-2 ~]# sed -i &quot;s#KUBELET_API_SERVER=\&quot;--api-servers=http://127.0.0.1:8080\&quot;#KUBELET_API_SERVER=\&quot;--api-servers=http://$&#123;KUBE_MASTER&#125;:8080\&quot;#g&quot; /etc/kubernetes/kubelet</div></pre></td></tr></table></figure>
<ul>
<li>启动</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[root@k8s-2 ~]# vi node_service.sh</div><div class="line">for SERVICE in docker kube-proxy kubelet</div><div class="line">do</div><div class="line">  systemctl enable $&#123;SERVICE&#125;.service</div><div class="line">  systemctl restart $&#123;SERVICE&#125;.service</div><div class="line">  systemctl status $&#123;SERVICE&#125;.service</div><div class="line">done</div></pre></td></tr></table></figure>
<ul>
<li>验证<blockquote>
<p>以下操作在master节点k8s-1上执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[root@k8s-1 ~]# kubectl -s http://k8s-1:8080 get node</div><div class="line">NAME      STATUS    AGE</div><div class="line">k8s-2     Ready     2h</div><div class="line">k8s-3     Ready     2h</div><div class="line"></div><div class="line">[root@k8s-1 ~]# kubectl get nodes</div><div class="line">NAME      STATUS    AGE</div><div class="line">k8s-2     Ready     2h</div><div class="line">k8s-3     Ready     2h</div></pre></td></tr></table></figure>
</blockquote>
</li>
</ul>
<ol>
<li>flannel安装和配置<blockquote>
<p>以下操作在k8s-2和k8s-3两台主机上均执行，此处以k8s-2主机为例进行讲解</p>
</blockquote>
</li>
</ol>
<ul>
<li><p>安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@k8s-2 ~]# yum -y install flannel.x86_64</div></pre></td></tr></table></figure>
</li>
<li><p>配置</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@k8s-2 ~]# ETCD_SERVERS=&apos;http://192.168.111.6:2379,192.168.111.7:2379,192.168.111.8:2379&apos;</div><div class="line">[root@k8s-2 ~]# sed -i &quot;s#FLANNEL_ETCD_ENDPOINTS=\&quot;http://127.0.0.1:2379\&quot;#FLANNEL_ETCD_ENDPOINTS=\&quot;$&#123;ETCD_SERVERS&#125;\&quot;#g&quot; /etc/sysconfig/flanneld</div></pre></td></tr></table></figure>
<p>在k8s-1、在k8s-2和在k8s-3任意一个etcd主机上，执行关于flannel key的配置，此处以k8s-1主机为例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@k8s-1 ~]# etcdctl mk /atomic.io/network/config &apos;&#123; &quot;Network&quot;: &quot;172.17.0.0/16&quot; &#125;&apos;</div></pre></td></tr></table></figure>
<ul>
<li>启动</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@k8s-2 ~]# systemctl enable flanneld.service</div><div class="line">[root@k8s-2 ~]# systemctl restart flanneld.service</div></pre></td></tr></table></figure>
<ol>
<li>服务发布测试</li>
</ol>
<ul>
<li>镜像拉取<blockquote>
<p>在k8s-2和k8s-3两个node主机上，从163拉取nginx镜像，此处以k8s-2主机为例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@k8s-2 ~]# docker pull hub.c.163.com/library/nginx:latest</div></pre></td></tr></table></figure>
</blockquote>
</li>
</ul>
<blockquote>
<p>服务发布测试在k8s-1对应的master节点进行</p>
</blockquote>
<ul>
<li><p>创建pod</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">[root@k8s-1 ~]# vi nginx-pod.yaml</div><div class="line">apiVersion: v1</div><div class="line">kind: Pod</div><div class="line">metadata:</div><div class="line"> name: nginx-pod</div><div class="line"> labels:</div><div class="line">  name: nginx-pod</div><div class="line">spec:</div><div class="line"> containers:</div><div class="line"> - name: nginx</div><div class="line">   image: hub.c.163.com/library/nginx:latest</div><div class="line">   ports:</div><div class="line">   - containerPort: 80</div><div class="line">   </div><div class="line">[root@k8s-1 ~]# kubectl create -f nginx-pod.yaml</div></pre></td></tr></table></figure>
</li>
<li><p>查看pod状态</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[root@k8s-1 ~]# kubectl get pods</div><div class="line">NAME        READY     STATUS              RESTARTS   AGE</div><div class="line">nginx-pod   0/1       ContainerCreating   0          2s</div><div class="line">[root@k8s-1 ~]# kubectl get pods</div><div class="line">NAME        READY     STATUS    RESTARTS   AGE</div><div class="line">nginx-pod   1/1       Running   0          4m</div></pre></td></tr></table></figure>
<ul>
<li>创建rc</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">vi nginx-rc.yaml</div><div class="line">apiVersion: v1</div><div class="line">kind: ReplicationController</div><div class="line">metadata:</div><div class="line"> name: nginx-rc</div><div class="line">spec:</div><div class="line"> replicas: 1</div><div class="line"> selector:</div><div class="line">  name: nginx-pod</div><div class="line"> template:</div><div class="line">  metadata:</div><div class="line">   labels:</div><div class="line">    name: nginx-pod</div><div class="line">  spec:</div><div class="line">   containers:</div><div class="line">   - name: nginx-pod</div><div class="line">     image: hub.c.163.com/library/nginx:latest</div><div class="line">     ports:</div><div class="line">     - containerPort: 80</div><div class="line"></div><div class="line">[root@k8s-1 ~]# kubectl create -f nginx-rc.yaml</div></pre></td></tr></table></figure>
<ul>
<li>查看rc状态</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[root@k8s-1 ~]# kubectl get rc</div><div class="line">NAME       DESIRED   CURRENT   READY     AGE</div><div class="line">nginx-rc   1         1         1         32s</div></pre></td></tr></table></figure>
<ul>
<li>创建service</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">vi nginx-service.yaml</div><div class="line">apiVersion: v1</div><div class="line">kind: Service</div><div class="line">metadata:</div><div class="line"> name: nginx-service</div><div class="line">spec:</div><div class="line"> type: NodePort</div><div class="line"> ports:</div><div class="line"> - port: 80</div><div class="line">   nodePort: 30001</div><div class="line"> selector:</div><div class="line">  name: nginx-pod</div><div class="line">  </div><div class="line">[root@k8s-1 ~]# kubectl create -f nginx-service.yaml</div></pre></td></tr></table></figure>
<ul>
<li>查看service状态</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[root@k8s-1 ~]# kubectl get service</div><div class="line">NAME            CLUSTER-IP     EXTERNAL-IP   PORT(S)        AGE</div><div class="line">kubernetes      10.254.0.1     &lt;none&gt;        443/TCP        14h</div><div class="line">nginx-service   10.254.80.12   &lt;nodes&gt;       80:30001/TCP   5s</div></pre></td></tr></table></figure>
<ul>
<li>测试发布的nginx服务</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">http://192.168.111.7:30001</div><div class="line">http://192.168.111.8:30001</div></pre></td></tr></table></figure>
<ol>
<li>参考</li>
</ol>
<p><a href="http://www.cnblogs.com/zhenyuyaodidiao/p/6500830.html" target="_blank" rel="external">http://www.cnblogs.com/zhenyuyaodidiao/p/6500830.html</a><br><a href="http://blog.csdn.net/u013760355/article/details/68061976" target="_blank" rel="external">http://blog.csdn.net/u013760355/article/details/68061976</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;ol&gt;
&lt;li&gt;主机&lt;/li&gt;
&lt;/ol&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;IP&lt;/th&gt;
&lt;th&gt;hostname&lt;/th&gt;
&lt;th&gt;角色&lt;/th&gt;
&lt;th&gt;服务&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;192.168.11
    
    </summary>
    
    
  </entry>
  
</feed>
